import{u as I}from"./ali-oss.00c50729.js";import{d as U,cp as P,aC as k,w as p,r as m,o as h,n as b,p as r,J as j,N as D}from"./index.b7a14d4f.js";import{P as q}from"./PlusOutlined.5bcc416d.js";import{U as R}from"./index.5cf0b4b1.js";import"./vendor.352e3120.js";import"./upload.f0e5cf62.js";import"./uniqBy.272154d9.js";import"./_baseIteratee.580b2020.js";import"./get.17b5f080.js";import"./hasIn.55ea5e75.js";import"./_baseProperty.74f89655.js";import"./findIndex.ca0f29b6.js";import"./toInteger.085db34b.js";import"./index.b7943f07.js";import"./FileOutlined.633a7a92.js";import"./DeleteOutlined.123b484f.js";function L(e){return new Promise((a,n)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>a(o.result),o.onerror=l=>n(l)})}var w=U({components:{PlusOutlined:q,Upload:R,Modal:P},name:"SkuImage",props:{max:k.number,skuDTO:Object},emits:["uploadSuccess"],setup(e,{emit:a}){const n=p(!1),o=p(""),l=p([]);return e.skuDTO.imgUrl&&l.value.push({uid:"-1",name:"image.png",status:"done",url:e.skuDTO.imgUrl}),{previewVisible:n,previewImage:o,fileList:l,handleCancel:()=>{n.value=!1},handlePreview:async s=>{!s.url&&!s.preview&&(s.preview=await L(s.originFileObj)),o.value=s.url||s.preview,n.value=!0},handleChange:s=>{s.file.status==="uploading"},customRequest:s=>{const i=s.file;let u=i.name,C=u.lastIndexOf("."),O=u.substr(C),y=`${Date.parse(new Date)}`+parseInt(Math.random()*1e4)+O;I(y,i).then(d=>{console.log("res",d.res);let t=d.res.requestUrls[0];t.indexOf("uploadId=")>0&&(t=t.split("?uploadId=")[0]),t=t.split("?uploadId=")[0],console.log(t),l.value=[{uid:"-1",name:"image.png",status:"done",url:t}],a("uploadSuccess",t),e.skuDTO.imgUrl=t}).catch(d=>{console.log(d),i.status="failed"})},beforeUpload:s=>{console.log(s);const i=s.type==="image/jpeg"||s.type==="image/png",u=s.size/1024/1024<10;return i&&u}}}}),Z="";const T={class:"clearfix"},x={key:0},M=r("div",{class:"ant-upload-text"},"\u4E0A\u4F20",-1);function $(e,a,n,o,l,_){const c=m("plus-outlined"),f=m("Upload"),g=m("Modal");return h(),b("div",T,[r(f,{"file-list":e.fileList,"onUpdate:file-list":a[1]||(a[1]=v=>e.fileList=v),customRequest:e.customRequest,onChange:e.handleChange,"list-type":"picture-card",class:"sku-uploade",onPreview:e.handlePreview},{default:j(()=>[e.fileList.length<e.max?(h(),b("div",x,[r(c),M])):D("",!0)]),_:1},8,["file-list","customRequest","onChange","onPreview"]),r(g,{visible:e.previewVisible,footer:null,onCancel:e.handleCancel},{default:j(()=>[r("img",{alt:"example",style:{width:"100%"},src:e.previewImage},null,8,["src"])]),_:1},8,["visible","onCancel"])])}w.render=$;export default w;
