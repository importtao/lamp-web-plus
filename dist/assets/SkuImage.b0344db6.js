import{u as I}from"./ali-oss.ed3c06da.js";import{d as U,cp as P,aC as k,w as p,r as m,o as h,n as j,p as r,J as w,N as D}from"./index.ff8e7350.js";import{P as q}from"./PlusOutlined.5ec69f0c.js";import{U as R}from"./index.0188a107.js";import"./vendor.352e3120.js";import"./upload.7400f53a.js";import"./uniqBy.ad809f18.js";import"./_baseIteratee.219a0b59.js";import"./get.25e661a1.js";import"./hasIn.cdeedf38.js";import"./_baseProperty.74f89655.js";import"./findIndex.fb260bab.js";import"./toInteger.3d2a7161.js";import"./index.61e91689.js";import"./FileOutlined.c1895460.js";import"./DeleteOutlined.11a704c5.js";function L(e){return new Promise((o,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>o(a.result),a.onerror=l=>n(l)})}var _=U({components:{PlusOutlined:q,Upload:R,Modal:P},name:"SkuImage",props:{max:k.number,skuDTO:Object},emits:["uploadSuccess"],setup(e,{emit:o}){const n=p(!1),a=p(""),l=p([]);return e.skuDTO.imgUrl&&l.value.push({uid:"-1",name:"image.png",status:"done",url:e.skuDTO.imgUrl}),{previewVisible:n,previewImage:a,fileList:l,handleCancel:()=>{n.value=!1},handlePreview:async s=>{!s.url&&!s.preview&&(s.preview=await L(s.originFileObj)),a.value=s.url||s.preview,n.value=!0},handleChange:s=>{s.file.status==="uploading"},customRequest:s=>{const i=s.file;let d=i.name,C=d.lastIndexOf("."),O=d.substr(C),y=`${Date.parse(new Date)}`+parseInt(Math.random()*1e4)+O;I(y,i).then(u=>{console.log("res",u.res);let t=u.res.requestUrls[0];t.indexOf("uploadId=")>0&&(t=t.split("?uploadId=")[0]),t=t.split("?uploadId=")[0],console.log(t),l.value=[{uid:"-1",name:"image.png",status:"done",url:t}],o("uploadSuccess",t),e.skuDTO.imgUrl=t}).catch(u=>{console.log(u),i.status="failed"})},beforeUpload:s=>{console.log(s);const i=s.type==="image/jpeg"||s.type==="image/png",d=s.size/1024/1024<10;return i&&d}}}}),Z="";const T={class:"clearfix"},x={key:0},M=r("div",{class:"ant-upload-text"},"\u4E0A\u4F20",-1);function $(e,o,n,a,l,b){const c=m("plus-outlined"),f=m("Upload"),g=m("Modal");return h(),j("div",T,[r(f,{"file-list":e.fileList,"onUpdate:file-list":o[1]||(o[1]=v=>e.fileList=v),customRequest:e.customRequest,onChange:e.handleChange,"list-type":"picture-card",class:"sku-uploade",onPreview:e.handlePreview},{default:w(()=>[e.fileList.length<e.max?(h(),j("div",x,[r(c),M])):D("",!0)]),_:1},8,["file-list","customRequest","onChange","onPreview"]),r(g,{visible:e.previewVisible,footer:null,onCancel:e.handleCancel},{default:w(()=>[r("img",{alt:"example",style:{width:"100%"},src:e.previewImage},null,8,["src"])]),_:1},8,["visible","onCancel"])])}_.render=$;export default _;
