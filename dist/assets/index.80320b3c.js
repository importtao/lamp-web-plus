import{S as r,d as $,Q as O,R,a2 as _,a1 as W,Z as d,_ as p,Y as M,b1 as U,cw as T,p as v,W as D,bk as b,U as z,O as X,as as G,$ as Y,w as Q,x as Z,V as J,a0 as ee,X as te,br as ie,a3 as se}from"./index.b361f078.js";import{U as re}from"./UpOutlined.cbb592c6.js";var ne={disabled:r.looseBool,activeClassName:r.string,activeStyle:r.any},ae=$({name:"TouchFeedback",mixins:[O],inheritAttrs:!1,props:R(ne,{disabled:!1}),data:function(){return this.child=null,{active:!1}},mounted:function(){var e=this;this.$nextTick(function(){e.disabled&&e.active&&e.setState({active:!1})})},methods:{triggerEvent:function(e,t,i){var s="on".concat(e),a=this.child;a.props[s]&&a.props[s](i),t!==this.active&&this.setState({active:t})},onTouchStart:function(e){this.triggerEvent("Touchstart",!0,e)},onTouchMove:function(e){this.triggerEvent("Touchmove",!1,e)},onTouchEnd:function(e){this.triggerEvent("Touchend",!1,e)},onTouchCancel:function(e){this.triggerEvent("Touchcancel",!1,e)},onMouseDown:function(e){this.triggerEvent("Mousedown",!0,e)},onMouseUp:function(e){this.triggerEvent("Mouseup",!1,e)},onMouseLeave:function(e){this.triggerEvent("Mouseleave",!1,e)}},render:function(){var e,t=this.$props,i=t.disabled,s=t.activeClassName,a=s===void 0?"":s,o=t.activeStyle,u=o===void 0?{}:o,l=_(this);if(l.length!==1)return W(!1,"m-feedback\u7EC4\u4EF6\u53EA\u80FD\u5305\u542B\u4E00\u4E2A\u5B50\u5143\u7D20"),null;var h=i?void 0:(e={},d(e,T?"onTouchstartPassive":"onTouchstart",this.onTouchStart),d(e,T?"onTouchmovePassive":"onTouchmove",this.onTouchMove),d(e,"onTouchend",this.onTouchEnd),d(e,"onTouchcancel",this.onTouchCancel),d(e,"onMousedown",this.onMouseDown),d(e,"onMouseup",this.onMouseUp),d(e,"onMouseleave",this.onMouseLeave),e);if(l=l[0],this.child=l,!i&&this.active){var c=l.props,f=c.style,m=c.class;return u!==!1&&(u&&(f=p(p({},f),u)),m=M(m,a)),U(l,p({class:m,style:f},h))}return U(l,h)}}),K={name:"InputHandler",inheritAttrs:!1,props:{prefixCls:r.string,disabled:r.looseBool},render:function(){var e=this,t=this.$props,i=t.prefixCls,s=t.disabled,a={disabled:s,activeClassName:"".concat(i,"-handler-active")};return v(ae,a,{default:function(){return[v("span",e.$attrs,[_(e)])]}})}};function H(n){n.preventDefault()}function oe(n){return n.replace(/[^\w\.-]+/g,"")}var ue=200,le=600,ce=Number.MAX_SAFE_INTEGER||Math.pow(2,53)-1,P=function(e){return e!=null},E=function(e,t){return t===e||typeof t=="number"&&typeof e=="number"&&isNaN(t)&&isNaN(e)},he={value:r.oneOfType([r.number,r.string]),defaultValue:r.oneOfType([r.number,r.string]),focusOnUpDown:r.looseBool,autofocus:r.looseBool,prefixCls:r.string,tabindex:r.oneOfType([r.string,r.number]),placeholder:r.string,disabled:r.looseBool,readonly:r.looseBool,max:r.number,min:r.number,step:r.oneOfType([r.number,r.string]),upHandler:r.any,downHandler:r.any,useTouch:r.looseBool,formatter:r.func,parser:r.func,precision:r.number,required:r.looseBool,pattern:r.string,decimalSeparator:r.string,autocomplete:r.string,title:r.string,name:r.string,id:r.string,type:r.string,maxlength:r.any},pe=$({name:"VCInputNumber",mixins:[O],inheritAttrs:!1,props:R(he,{focusOnUpDown:!0,useTouch:!1,prefixCls:"rc-input-number",min:-ce,step:1,parser:oe,required:!1,autocomplete:"off"}),data:function(){var e=D(this);this.prevProps=p({},e);var t;"value"in e?t=this.value:t=this.defaultValue;var i=this.getValidValue(this.toNumber(t));return{inputValue:this.toPrecisionAsStep(i),sValue:i,focused:this.autofocus}},mounted:function(){var e=this;this.$nextTick(function(){e.updatedFunc()})},updated:function(){var e=this,t=this.$props,i=t.value,s=t.max,a=t.min,o=this.$data.focused,u=this.prevProps,l=D(this);if(u){if(!E(u.value,i)||!E(u.max,s)||!E(u.min,a)){var h=o?i:this.getValidValue(i),c;this.pressingUpOrDown?c=h:this.inputting?c=this.rawInput:c=this.toPrecisionAsStep(h),this.setState({sValue:h,inputValue:c})}var f="value"in l?i:this.$data.sValue;"max"in l&&u.max!==s&&typeof f=="number"&&f>s&&this.__emit("change",s),"min"in l&&u.min!==a&&typeof f=="number"&&f<a&&this.__emit("change",a)}this.prevProps=p({},l),this.$nextTick(function(){e.updatedFunc()})},beforeUnmount:function(){this.stop()},methods:{updatedFunc:function(){var e=this.inputRef;try{if(this.cursorStart!==void 0&&this.$data.focused){if(!this.partRestoreByAfter(this.cursorAfter)&&this.$data.sValue!==this.value){var t=this.cursorStart+1;this.cursorAfter?this.lastKeyCode===b.BACKSPACE?t=this.cursorStart-1:this.lastKeyCode===b.DELETE&&(t=this.cursorStart):t=e.value.length,this.fixCaret(t,t)}else if(this.currentValue===e.value)switch(this.lastKeyCode){case b.BACKSPACE:this.fixCaret(this.cursorStart-1,this.cursorStart-1);break;case b.DELETE:this.fixCaret(this.cursorStart+1,this.cursorStart+1);break;default:}}}catch(i){}this.lastKeyCode=null,!!this.pressingUpOrDown&&(this.focusOnUpDown&&this.$data.focused&&document.activeElement!==e&&this.focus(),this.pressingUpOrDown=!1)},onKeyDown:function(e){if(e.keyCode===b.UP){var t=this.getRatio(e);this.up(e,t),this.stop()}else if(e.keyCode===b.DOWN){var i=this.getRatio(e);this.down(e,i),this.stop()}else e.keyCode===b.ENTER&&this.__emit("pressEnter",e);this.recordCursorPosition(),this.lastKeyCode=e.keyCode;for(var s=arguments.length,a=new Array(s>1?s-1:0),o=1;o<s;o++)a[o-1]=arguments[o];this.__emit.apply(this,["keydown",e].concat(a))},onKeyUp:function(e){this.stop(),this.recordCursorPosition();for(var t=arguments.length,i=new Array(t>1?t-1:0),s=1;s<t;s++)i[s-1]=arguments[s];this.__emit.apply(this,["keyup",e].concat(i))},onTrigger:function(e){if(e.target.composing)return!1;this.onChange(e)},onChange:function(e){this.$data.focused&&(this.inputting=!0),this.rawInput=this.parser(this.getValueFromEvent(e)),this.setState({inputValue:this.rawInput});var t=this.toNumber(this.rawInput);this.__emit("change",t)},onFocus:function(){this.setState({focused:!0});for(var e=arguments.length,t=new Array(e),i=0;i<e;i++)t[i]=arguments[i];this.__emit.apply(this,["focus"].concat(t))},onBlur:function(){this.inputting=!1,this.setState({focused:!1});var e=this.getCurrentValidValue(this.$data.inputValue),t=this.setValue(e);if(this.$attrs.onBlur&&this.inputRef){var i=this.inputRef.value,s=this.getInputDisplayValue({focused:!1,sValue:t});this.inputRef.value=s;for(var a=arguments.length,o=new Array(a),u=0;u<a;u++)o[u]=arguments[u];this.__emit.apply(this,["blur"].concat(o)),this.inputRef.value=i}},getCurrentValidValue:function(e){var t=e;return t===""?t="":this.isNotCompleteNumber(parseFloat(t,10))?t=this.$data.sValue:t=this.getValidValue(t),this.toNumber(t)},getRatio:function(e){var t=1;return e.metaKey||e.ctrlKey?t=.1:e.shiftKey&&(t=10),t},getValueFromEvent:function(e){var t=e.target.value.trim().replace(/ã€‚/g,".");return P(this.decimalSeparator)&&(t=t.replace(this.decimalSeparator,".")),t},getValidValue:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.min,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.max,s=parseFloat(e,10);return isNaN(s)?e:(s<t&&(s=t),s>i&&(s=i),s)},setValue:function(e,t){var i=this.$props.precision,s=this.isNotCompleteNumber(parseFloat(e,10))?null:parseFloat(e,10),a=this.$data,o=a.sValue,u=o===void 0?null:o,l=a.inputValue,h=l===void 0?null:l,c=typeof s=="number"?s.toFixed(i):"".concat(s),f=s!==u||c!=="".concat(h);return z(this,"value")?this.setState({inputValue:this.toPrecisionAsStep(this.$data.sValue)},t):this.setState({sValue:s,inputValue:this.toPrecisionAsStep(e)},t),f&&this.__emit("change",s),s},getPrecision:function(e){if(P(this.precision))return this.precision;var t=e.toString();if(t.indexOf("e-")>=0)return parseInt(t.slice(t.indexOf("e-")+2),10);var i=0;return t.indexOf(".")>=0&&(i=t.length-t.indexOf(".")-1),i},getMaxPrecision:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;if(P(this.precision))return this.precision;var i=this.step,s=this.getPrecision(t),a=this.getPrecision(i),o=this.getPrecision(e);return e?Math.max(o,s+a):s+a},getPrecisionFactor:function(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=this.getMaxPrecision(e,t);return Math.pow(10,i)},getInputDisplayValue:function(e){var t=e||this.$data,i=t.focused,s=t.inputValue,a=t.sValue,o;i?o=s:o=this.toPrecisionAsStep(a),o==null&&(o="");var u=this.formatWrapper(o);return P(this.$props.decimalSeparator)&&(u=u.toString().replace(".",this.$props.decimalSeparator)),u},recordCursorPosition:function(){try{var e=this.inputRef;this.cursorStart=e.selectionStart,this.cursorEnd=e.selectionEnd,this.currentValue=e.value,this.cursorBefore=e.value.substring(0,this.cursorStart),this.cursorAfter=e.value.substring(this.cursorEnd)}catch(t){}},fixCaret:function(e,t){if(!(e===void 0||t===void 0||!this.inputRef||!this.inputRef.value))try{var i=this.inputRef,s=i.selectionStart,a=i.selectionEnd;(e!==s||t!==a)&&i.setSelectionRange(e,t)}catch(o){}},restoreByAfter:function(e){if(e===void 0)return!1;var t=this.inputRef.value,i=t.lastIndexOf(e);if(i===-1)return!1;var s=this.cursorBefore.length;return this.lastKeyCode===b.DELETE&&this.cursorBefore.charAt(s-1)===e[0]?(this.fixCaret(s,s),!0):i+e.length===t.length?(this.fixCaret(i,i),!0):!1},partRestoreByAfter:function(e){var t=this;return e===void 0?!1:Array.prototype.some.call(e,function(i,s){var a=e.substring(s);return t.restoreByAfter(a)})},focus:function(){this.inputRef.focus(),this.recordCursorPosition()},blur:function(){this.inputRef.blur()},formatWrapper:function(e){return this.formatter?this.formatter(e):e},toPrecisionAsStep:function(e){if(this.isNotCompleteNumber(e)||e==="")return e;var t=Math.abs(this.getMaxPrecision(e));return isNaN(t)?e.toString():Number(e).toFixed(t)},isNotCompleteNumber:function(e){return isNaN(e)||e===""||e===null||e&&e.toString().indexOf(".")===e.toString().length-1},toNumber:function(e){var t=this.$props,i=t.precision,s=t.autofocus,a=this.$data.focused,o=a===void 0?s:a,u=e&&e.length>16&&o;return this.isNotCompleteNumber(e)||u?e:P(i)?Math.round(e*Math.pow(10,i))/Math.pow(10,i):Number(e)},upStep:function(e,t){var i=this.step,s=this.getPrecisionFactor(e,t),a=Math.abs(this.getMaxPrecision(e,t)),o=((s*e+s*i*t)/s).toFixed(a);return this.toNumber(o)},downStep:function(e,t){var i=this.step,s=this.getPrecisionFactor(e,t),a=Math.abs(this.getMaxPrecision(e,t)),o=((s*e-s*i*t)/s).toFixed(a);return this.toNumber(o)},stepFn:function(e,t){var i=this,s=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,a=arguments.length>3?arguments[3]:void 0;if(this.stop(),t&&t.preventDefault(),!this.disabled){var o=this.max,u=this.min,l=this.getCurrentValidValue(this.$data.inputValue)||0;if(!this.isNotCompleteNumber(l)){var h=this["".concat(e,"Step")](l,s),c=h>o||h<u;h>o?h=o:h<u&&(h=u),this.setValue(h),this.setState({focused:!0}),!c&&(this.autoStepTimer=setTimeout(function(){i[e](t,s,!0)},a?ue:le))}}},stop:function(){this.autoStepTimer&&clearTimeout(this.autoStepTimer)},down:function(e,t,i){this.pressingUpOrDown=!0,this.stepFn("down",e,t,i)},up:function(e,t,i){this.pressingUpOrDown=!0,this.stepFn("up",e,t,i)},handleInputClick:function(){this.__emit("click")},saveUp:function(e){this.upHandlerRef=e},saveDown:function(e){this.downHandlerRef=e},saveInput:function(e){this.inputRef=e},onCompositionstart:function(e){e.target.composing=!0},onCompositionend:function(e){this.onChange(e),e.target.composing=!1}},render:function(){var e,t=p(p({},this.$props),this.$attrs),i=t.prefixCls,s=t.disabled,a=t.readonly,o=t.useTouch,u=t.autocomplete,l=t.upHandler,h=t.downHandler,c=t.class,f=M((e={},d(e,c,c),d(e,i,!0),d(e,"".concat(i,"-disabled"),s),d(e,"".concat(i,"-focused"),this.$data.focused),e)),m="",g="",C=this.$data.sValue;if(C||C===0)if(isNaN(C))m="".concat(i,"-handler-up-disabled"),g="".concat(i,"-handler-down-disabled");else{var A=Number(C);A>=this.max&&(m="".concat(i,"-handler-up-disabled")),A<=this.min&&(g="".concat(i,"-handler-down-disabled"))}var F={};for(var x in t)t.hasOwnProperty(x)&&(x.substr(0,5)==="data-"||x.substr(0,5)==="aria-"||x==="role")&&(F[x]=t[x]);var y=!this.readonly&&!this.disabled,L=this.getInputDisplayValue(),V,N;if(o){var w,S;V=(w={},d(w,T?"onTouchstartPassive":"onTouchstart",y&&!m&&this.up),d(w,"onTouchend",this.stop),w),N=(S={},d(S,T?"onTouchstartPassive":"onTouchstart",y&&!g&&this.down),d(S,"onTouchend",this.stop),S)}else V={onMousedown:y&&!m&&this.up,onMouseup:this.stop,onMouseleave:this.stop},N={onMousedown:y&&!g&&this.down,onMouseup:this.stop,onMouseleave:this.stop};var I=!!m||s||a,B=!!g||s||a,k=p(p({disabled:I,prefixCls:i,unselectable:"unselectable",role:"button","aria-label":"Increase Value","aria-disabled":!!I,class:"".concat(i,"-handler ").concat(i,"-handler-up ").concat(m)},V),{},{ref:this.saveUp}),j=p(p({disabled:B,prefixCls:i,unselectable:"unselectable",role:"button","aria-label":"Decrease Value","aria-disabled":!!B,class:"".concat(i,"-handler ").concat(i,"-handler-down ").concat(g)},N),{},{ref:this.saveDown});return v("div",{class:f,style:t.style,title:t.title,onMouseenter:t.onMouseenter,onMouseleave:t.onMouseleave,onMouseover:t.onMouseover,onMouseout:t.onMouseout},[v("div",{class:"".concat(i,"-handler-wrap")},[v("span",null,[v(K,p(p({},k),{},{key:"upHandler"}),{default:function(){return[l||v("span",{unselectable:"unselectable",class:"".concat(i,"-handler-up-inner"),onClick:H},null)]}})]),v(K,p(p({},j),{},{key:"downHandler"}),{default:function(){return[h||v("span",{unselectable:"unselectable",class:"".concat(i,"-handler-down-inner"),onClick:H},null)]}})]),v("div",{class:"".concat(i,"-input-wrap")},[v("input",p({role:"spinbutton","aria-valuemin":this.min,"aria-valuemax":this.max,"aria-valuenow":C,required:this.required,type:t.type,placeholder:this.placeholder,onClick:this.handleInputClick,class:"".concat(i,"-input"),tabindex:this.tabindex,autocomplete:u,onFocus:this.onFocus,onBlur:this.onBlur,onKeydown:y&&this.onKeyDown,onKeyup:y&&this.onKeyUp,autofocus:this.autofocus,maxlength:this.maxlength,readonly:this.readonly,disabled:this.disabled,max:this.max,min:this.min,step:this.step,name:this.name,title:this.title,id:this.id,onInput:this.onTrigger,onCompositionstart:this.onCompositionstart,onCompositionend:this.onCompositionend,ref:this.saveInput,value:L,pattern:this.pattern},F),null)])])}}),fe=["prefixCls","size","class","id"],de={prefixCls:r.string,min:r.number,max:r.number,value:r.oneOfType([r.number,r.string]),step:r.oneOfType([r.number,r.string]).def(1),defaultValue:r.oneOfType([r.number,r.string]),tabindex:r.oneOfType([r.number,r.string]),disabled:r.looseBool,size:r.oneOf(G("large","small","default")),formatter:r.func,parser:r.func,decimalSeparator:r.string,placeholder:r.string,name:r.string,id:r.string,precision:r.number,autofocus:r.looseBool,onPressEnter:{type:Function},onChange:Function},ve=$({name:"AInputNumber",inheritAttrs:!1,props:de,emits:["input","change","blur","update:value"],setup:function(e,t){var i=t.emit,s=Y(),a=Q(null),o=function(){a.value.focus()},u=function(){a.value.blur()},l=function(f){i("update:value",f),i("change",f)},h=function(){i("blur")};return Z(function(){J(function(){})}),{configProvider:ee("configProvider",se),inputNumberRef:a,focus:o,blur:u,formItemContext:s,handleBlur:h,handleChange:l}},render:function(){var e,t=p(p({},D(this)),this.$attrs),i=t.prefixCls,s=t.size,a=t.class,o=t.id,u=o===void 0?this.formItemContext.id.value:o,l=te(t,fe),h=this.configProvider.getPrefixCls,c=h("input-number",i),f=M((e={},d(e,"".concat(c,"-lg"),s==="large"),d(e,"".concat(c,"-sm"),s==="small"),e),a),m=v(re,{class:"".concat(c,"-handler-up-inner")},null),g=v(ie,{class:"".concat(c,"-handler-down-inner")},null),C=p(p({prefixCls:c,upHandler:m,downHandler:g},l),{},{class:f,onChange:this.handleChange,onBlur:this.handleBlur,id:u});return v(pe,p(p({},C),{},{ref:"inputNumberRef"}),null)}}),me=X(ve);export{me as I};
