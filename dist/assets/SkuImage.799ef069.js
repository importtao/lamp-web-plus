import{u as I}from"./ali-oss.3141d013.js";import{d as U,cp as P,aC as k,w as p,r as c,o as h,n as b,p as r,J as j,N as D}from"./index.b6dfbfcf.js";import{P as q}from"./PlusOutlined.84d8b58b.js";import{U as R}from"./index.672abebf.js";import"./vendor.352e3120.js";import"./upload.4cde268e.js";import"./uniqBy.c4f2e7ec.js";import"./_baseIteratee.2e9463e3.js";import"./get.4daef9c8.js";import"./hasIn.babd797c.js";import"./_baseProperty.74f89655.js";import"./findIndex.c7191173.js";import"./toInteger.e4331dbc.js";import"./index.1aad4d44.js";import"./FileOutlined.44378449.js";import"./DeleteOutlined.e9575d1c.js";function L(e){return new Promise((a,n)=>{const o=new FileReader;o.readAsDataURL(e),o.onload=()=>a(o.result),o.onerror=l=>n(l)})}var w=U({components:{PlusOutlined:q,Upload:R,Modal:P},name:"SkuImage",props:{max:k.number,skuDTO:Object},emits:["uploadSuccess"],setup(e,{emit:a}){const n=p(!1),o=p(""),l=p([]);return e.skuDTO.imgUrl&&l.value.push({uid:"-1",name:"image.png",status:"done",url:e.skuDTO.imgUrl}),{previewVisible:n,previewImage:o,fileList:l,handleCancel:()=>{n.value=!1},handlePreview:async s=>{!s.url&&!s.preview&&(s.preview=await L(s.originFileObj)),o.value=s.url||s.preview,n.value=!0},handleChange:s=>{s.file.status==="uploading"},customRequest:s=>{const i=s.file;let d=i.name,C=d.lastIndexOf("."),O=d.substr(C),y=`${Date.parse(new Date)}`+parseInt(Math.random()*1e4)+O;I(y,i).then(u=>{console.log("res",u.res);let t=u.res.requestUrls[0];t.indexOf("uploadId=")>0&&(t=t.split("?uploadId=")[0]),t=t.split("?uploadId=")[0],console.log(t),l.value=[{uid:"-1",name:"image.png",status:"done",url:t}],a("uploadSuccess",t),e.skuDTO.imgUrl=t}).catch(u=>{console.log(u),i.status="failed"})},beforeUpload:s=>{console.log(s);const i=s.type==="image/jpeg"||s.type==="image/png",d=s.size/1024/1024<10;return i&&d}}}}),Z="";const T={class:"clearfix"},x={key:0},M=r("div",{class:"ant-upload-text"},"\u4E0A\u4F20",-1);function $(e,a,n,o,l,_){const m=c("plus-outlined"),f=c("Upload"),g=c("Modal");return h(),b("div",T,[r(f,{"file-list":e.fileList,"onUpdate:file-list":a[1]||(a[1]=v=>e.fileList=v),customRequest:e.customRequest,onChange:e.handleChange,"list-type":"picture-card",class:"sku-uploade",onPreview:e.handlePreview},{default:j(()=>[e.fileList.length<e.max?(h(),b("div",x,[r(m),M])):D("",!0)]),_:1},8,["file-list","customRequest","onChange","onPreview"]),r(g,{visible:e.previewVisible,footer:null,onCancel:e.handleCancel},{default:j(()=>[r("img",{alt:"example",style:{width:"100%"},src:e.previewImage},null,8,["src"])]),_:1},8,["visible","onCancel"])])}w.render=$;export default w;
