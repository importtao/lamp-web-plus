var s=Object.assign;import{_ as E,a as A}from"./useDrawer.c824a5fb.js";import{_ as B}from"./BasicForm.2f71c419.js";import{u as O}from"./useForm.f47588eb.js";import{cu as n,be as m,j as w,d as j,w as U,D as S,F as $,r as D,o as k,n as q,J as x,p as H,s as C}from"./index.05ea33df.js";import{S as l,A as f}from"./commonEnum.da040d67.js";import{g as L}from"./formValidateService.342f23c9.js";import{f as Y}from"./general.691e4fff.js";const r={Page:{url:l.AUTHORITY+"/role/page",method:n.POST},Save:{url:l.AUTHORITY+"/role",method:n.POST},Update:{url:l.AUTHORITY+"/role",method:n.PUT},Delete:{url:l.AUTHORITY+"/role",method:n.DELETE},Query:{url:l.AUTHORITY+"/role/query",method:n.POST}},V=o=>m.request(s(s({},r.Page),{params:o})),G=o=>m.request(s(s({},r.Save),{params:o})),M=o=>m.request(s(s({},r.Update),{params:o})),z=o=>m.request(s(s({},r.Delete),{params:o})),{t:e}=w(),J=[{title:e("lamp.system.role.name"),dataIndex:"name"},{title:e("lamp.system.role.code"),dataIndex:"code"},{title:e("lamp.system.role.describe"),dataIndex:"describe"},{title:e("lamp.system.role.state"),dataIndex:"state"},{title:e("lamp.system.role.readonly"),dataIndex:"readonly"},{title:e("lamp.system.role.dsType"),dataIndex:"dsType"},{title:e("lamp.common.createTime"),dataIndex:"createTime",sorter:!0,width:180}],N=[{label:e("lamp.system.role.name"),field:"name",component:"Input",colProps:{span:5}},{label:e("lamp.system.role.code"),field:"code",component:"Input",colProps:{span:5}},{field:"createTimeRange",label:e("lamp.common.createTime"),component:"RangePicker",colProps:{span:6}}],Q=[{field:"id",label:"ID",component:"Input",show:!1},{label:e("lamp.system.role.name"),field:"name",component:"Input"},{label:e("lamp.system.role.code"),field:"code",component:"Input"},{label:e("lamp.system.role.describe"),field:"describe",component:"Input"},{label:e("lamp.system.role.state"),field:"state",component:"RadioButtonGroup",componentProps:{options:[{label:e("lamp.common.yes"),value:!0},{label:e("lamp.common.no"),value:!1}]}},{label:e("lamp.system.role.readonly"),field:"readonly",component:"RadioButtonGroup",componentProps:{options:[{label:e("lamp.common.yes"),value:!0},{label:e("lamp.common.no"),value:!1}]}},{label:e("lamp.system.role.dsType"),field:"dsType",component:"ApiSelect",componentProps:{api:Y,params:["DataScopeType"],resultField:"DataScopeType"}}],W=o=>[];var y=j({name:"RoleEdit",components:{BasicDrawer:E,BasicForm:B},emits:["success","register"],setup(o,{emit:T}){const{t:c}=w(),a=U(f.ADD),{createMessage:b}=$(),[g,{setFieldsValue:i,resetFields:p,updateSchema:v,validate:_}]=O({labelWidth:100,schemas:Q,showActionButtonGroup:!1,actionColOptions:{span:23}}),[R,{setDrawerProps:d,closeDrawer:F}]=A(async t=>{await p(),d({confirmLoading:!1}),a.value=t==null?void 0:t.type;let h=r.Save;const I=s({},t==null?void 0:t.record);S(a)===f.EDIT?h=r.Update:I.id=void 0,await i(s({},I)),L(h,W()).then(async u=>{u&&u.length>0&&await v(u)})});async function P(){try{const t=await _();d({confirmLoading:!0}),S(a)===f.EDIT?await M(t):await G(t),b.success(c(`common.tips.${a.value}Success`)),F(),T("success")}finally{d({confirmLoading:!1})}}return{t:c,registerDrawer:R,registerForm:g,type:a,handleSubmit:P}}});function K(o,T,c,a,b,g){const i=D("BasicForm"),p=D("BasicDrawer");return k(),q(p,C(o.$attrs,{onRegister:o.registerDrawer,showFooter:"",width:"30%",maskClosable:!1,title:o.t(`common.title.${o.type}`),onOk:o.handleSubmit}),{default:x(()=>[H(i,{onRegister:o.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}y.render=K;var X=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:y});export{X as E,y as _,J as c,V as p,z as r,N as s};
