import{u as I}from"./ali-oss.382a9c69.js";import{d as U,cp as P,aC as k,w as p,r as c,o as h,n as b,p as r,J as j,N as D}from"./index.f012a3f4.js";import{P as q}from"./PlusOutlined.0c40939d.js";import{U as R}from"./index.3a3a0b83.js";import"./vendor.352e3120.js";import"./upload.f886bf9f.js";import"./uniqBy.1b31fa16.js";import"./_baseIteratee.c907cd0a.js";import"./get.4bb36d6d.js";import"./hasIn.e5f45297.js";import"./_baseProperty.74f89655.js";import"./findIndex.2bc5b0a2.js";import"./toInteger.87149fb4.js";import"./index.ccba4a8f.js";import"./FileOutlined.dfec8941.js";import"./DeleteOutlined.4af221e4.js";function L(e){return new Promise((o,n)=>{const a=new FileReader;a.readAsDataURL(e),a.onload=()=>o(a.result),a.onerror=l=>n(l)})}var w=U({components:{PlusOutlined:q,Upload:R,Modal:P},name:"SkuImage",props:{max:k.number,skuDTO:Object},emits:["uploadSuccess"],setup(e,{emit:o}){const n=p(!1),a=p(""),l=p([]);return e.skuDTO.imgUrl&&l.value.push({uid:"-1",name:"image.png",status:"done",url:e.skuDTO.imgUrl}),{previewVisible:n,previewImage:a,fileList:l,handleCancel:()=>{n.value=!1},handlePreview:async s=>{!s.url&&!s.preview&&(s.preview=await L(s.originFileObj)),a.value=s.url||s.preview,n.value=!0},handleChange:s=>{s.file.status==="uploading"},customRequest:s=>{const i=s.file;let u=i.name,C=u.lastIndexOf("."),O=u.substr(C),y=`${Date.parse(new Date)}`+parseInt(Math.random()*1e4)+O;I(y,i).then(d=>{console.log("res",d.res);let t=d.res.requestUrls[0];t.indexOf("uploadId=")>0&&(t=t.split("?uploadId=")[0]),t=t.split("?uploadId=")[0],console.log(t),l.value=[{uid:"-1",name:"image.png",status:"done",url:t}],o("uploadSuccess",t),e.skuDTO.imgUrl=t}).catch(d=>{console.log(d),i.status="failed"})},beforeUpload:s=>{console.log(s);const i=s.type==="image/jpeg"||s.type==="image/png",u=s.size/1024/1024<10;return i&&u}}}}),Z="";const T={class:"clearfix"},x={key:0},M=r("div",{class:"ant-upload-text"},"\u4E0A\u4F20",-1);function $(e,o,n,a,l,_){const m=c("plus-outlined"),f=c("Upload"),g=c("Modal");return h(),b("div",T,[r(f,{"file-list":e.fileList,"onUpdate:file-list":o[1]||(o[1]=v=>e.fileList=v),customRequest:e.customRequest,onChange:e.handleChange,"list-type":"picture-card",class:"sku-uploade",onPreview:e.handlePreview},{default:j(()=>[e.fileList.length<e.max?(h(),b("div",x,[r(m),M])):D("",!0)]),_:1},8,["file-list","customRequest","onChange","onPreview"]),r(g,{visible:e.previewVisible,footer:null,onCancel:e.handleCancel},{default:j(()=>[r("img",{alt:"example",style:{width:"100%"},src:e.previewImage},null,8,["src"])]),_:1},8,["visible","onCancel"])])}w.render=$;export default w;
