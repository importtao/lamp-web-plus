var o=Object.assign;import{_ as E,a as O}from"./useDrawer.78890a21.js";import{_ as A}from"./BasicForm.71637030.js";import{u as B}from"./useForm.eec49fca.js";import{cu as n,be as c,j as T,d as H,w as U,D,F as $,r as S,o as j,n as q,J as k,p as x,s as C}from"./index.0523a5a3.js";import{S as m,A as f}from"./commonEnum.da040d67.js";import{g as Y}from"./formValidateService.5ed66daa.js";const r={Page:{url:m.AUTHORITY+"/resource/page",method:n.POST},Save:{url:m.AUTHORITY+"/resource",method:n.POST},Update:{url:m.AUTHORITY+"/resource",method:n.PUT},Delete:{url:m.AUTHORITY+"/resource",method:n.DELETE},Query:{url:m.AUTHORITY+"/resource/query",method:n.POST}},L=e=>c.request(o(o({},r.Query),{params:e})),V=e=>c.request(o(o({},r.Save),{params:e})),M=e=>c.request(o(o({},r.Update),{params:e})),G=e=>c.request(o(o({},r.Delete),{params:e})),{t:s}=T(),Q=[{title:s("lamp.system.resource.code"),dataIndex:"code"},{title:s("lamp.system.resource.name"),dataIndex:"name"},{title:s("lamp.system.resource.menuId"),dataIndex:"menuId",defaultHidden:!0},{title:s("lamp.system.resource.describe"),dataIndex:"describe",defaultHidden:!0},{title:s("lamp.system.resource.readonly"),dataIndex:"readonly",defaultHidden:!0},{title:s("lamp.common.createTime"),dataIndex:"createTime",sorter:!0,width:180}],z=[{label:s("lamp.system.resource.code"),field:"code",component:"Input",colProps:{span:12}},{label:s("lamp.system.resource.name"),field:"name",component:"Input",colProps:{span:12}},{field:"createTimeRange",label:s("lamp.common.createTime"),component:"RangePicker",colProps:{span:12}}],J=[{field:"id",label:"ID",component:"Input",show:!1},{label:s("lamp.system.resource.code"),field:"code",component:"Input"},{label:s("lamp.system.resource.name"),field:"name",component:"Input"},{label:s("lamp.system.resource.menuId"),field:"menuId",component:"Input",componentProps:{disabled:!0}},{label:s("lamp.system.resource.describe"),field:"describe",component:"Input"},{label:s("lamp.system.resource.readonly"),field:"readonly",component:"RadioButtonGroup",componentProps:{options:[{label:s("lamp.common.yes"),value:!0},{label:s("lamp.common.no"),value:!1}]}}],N=e=>[];var y=H({name:"ResourceEdit",components:{BasicDrawer:E,BasicForm:A},emits:["success","register"],setup(e,{emit:I}){const{t:l}=T(),a=U(f.ADD),{createMessage:g}=$(),[b,{setFieldsValue:i,resetFields:u,updateSchema:_,validate:v}]=B({labelWidth:100,schemas:J,showActionButtonGroup:!1,actionColOptions:{span:23}}),[R,{setDrawerProps:d,closeDrawer:F}]=O(async t=>{await u(),d({confirmLoading:!1}),a.value=t==null?void 0:t.type;let h=r.Save;const w=o({},t==null?void 0:t.record);D(a)===f.EDIT?h=r.Update:w.id=void 0,await i(o({},w)),Y(h,N()).then(async p=>{p&&p.length>0&&await _(p)})});async function P(){try{const t=await v();d({confirmLoading:!0}),D(a)===f.EDIT?await M(t):await V(t),g.success(l(`common.tips.${a.value}Success`)),F(),I("success")}finally{d({confirmLoading:!1})}}return{t:l,registerDrawer:R,registerForm:b,type:a,handleSubmit:P}}});function W(e,I,l,a,g,b){const i=S("BasicForm"),u=S("BasicDrawer");return j(),q(u,C(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",width:"30%",maskClosable:!1,title:e.t(`common.title.${e.type}`),onOk:e.handleSubmit}),{default:k(()=>[x(i,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}y.render=W;var K=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:y});export{K as E,y as _,Q as c,L as q,G as r,z as s};
