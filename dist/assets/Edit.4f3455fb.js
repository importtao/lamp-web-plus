var m=Object.assign;import{_ as F,a as S}from"./useDrawer.3628b9ed.js";import{_ as B}from"./BasicForm.ba267815.js";import{u as T}from"./useForm.93cfb83b.js";import{j as k,d as j,w as $,D as b,F as E,r as A,o as L,n as R,J as x,p as C,s as q}from"./index.b6dfbfcf.js";import{A as c}from"./commonEnum.da040d67.js";import{A as w,u as O,s as P}from"./lackApply.fba4641a.js";import{g as U}from"./formValidateService.c9ec958e.js";const{t:e}=k(),V=[{title:e("lamp.materials.lackApply.name"),dataIndex:"name"},{title:e("lamp.materials.lackApply.sku"),dataIndex:"sku"},{title:e("lamp.materials.lackApply.requireType"),dataIndex:"requireType"},{title:e("lamp.materials.lackApply.emergencyLevel"),dataIndex:"emergencyLevel"},{title:e("lamp.materials.lackApply.status"),dataIndex:"status"},{title:"\u53D1\u8D77\u4EBA",dataIndex:"createUser",width:250},{title:e("lamp.common.createTime"),dataIndex:"createTime",sorter:!0,width:180}],M=[{field:"createTimeRange",label:e("lamp.common.createTime"),component:"RangePicker",colProps:{span:6}}],z=[{field:"id",label:"ID",component:"Input",show:!1},{label:e("lamp.materials.lackApply.name"),field:"name",component:"Input"},{label:e("lamp.materials.lackApply.sku"),field:"sku",component:"Input"},{label:e("lamp.materials.lackApply.unit"),field:"unit",component:"Input"},{label:e("lamp.materials.lackApply.useScene"),field:"useScene",component:"Input"},{label:e("lamp.materials.lackApply.requireType"),field:"requireType",component:"Input"},{label:e("lamp.materials.lackApply.emergencyLevel"),field:"emergencyLevel",component:"Input"},{label:e("lamp.materials.lackApply.status"),field:"status",component:"Input"},{label:e("lamp.materials.lackApply.imgUrl"),field:"imgUrl",component:"Input"},{label:e("lamp.materials.lackApply.remark"),field:"remark",component:"Input"}],G=t=>[];var p=j({name:"LackApplyEdit",components:{BasicDrawer:F,BasicForm:B},emits:["success","register"],setup(t,{emit:u}){const{t:l}=k(),s=$(c.ADD),{createMessage:d}=E(),[f,{setFieldsValue:r,resetFields:n,updateSchema:I,validate:h}]=T({labelWidth:100,schemas:z,showActionButtonGroup:!1,actionColOptions:{span:23}}),[_,{setDrawerProps:o,closeDrawer:D}]=S(async a=>{await n(),o({confirmLoading:!1}),s.value=a==null?void 0:a.type;let y=w.Save;const g=m({},a==null?void 0:a.record);b(s)===c.EDIT?y=w.Update:g.id=void 0,await r(m({},g)),U(y,G()).then(async i=>{i&&i.length>0&&await I(i)})});async function v(){try{const a=await h();o({confirmLoading:!0}),b(s)===c.EDIT?await O(a):await P(a),d.success(l(`common.tips.${s.value}Success`)),D(),u("success")}finally{o({confirmLoading:!1})}}return{t:l,registerDrawer:_,registerForm:f,type:s,handleSubmit:v}}});function J(t,u,l,s,d,f){const r=A("BasicForm"),n=A("BasicDrawer");return L(),R(n,q(t.$attrs,{onRegister:t.registerDrawer,showFooter:"",width:"30%",maskClosable:!1,title:t.t(`common.title.${t.type}`),onOk:t.handleSubmit}),{default:x(()=>[C(r,{onRegister:t.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}p.render=J;var N=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:p});export{N as E,p as _,V as c,M as s};
