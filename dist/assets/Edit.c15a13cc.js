var a=Object.assign;import{_,a as P}from"./useDrawer.78890a21.js";import{_ as v}from"./BasicForm.71637030.js";import{u as M}from"./useForm.eec49fca.js";import{cu as r,be as u,j as I,h as q,d as B,w as C,D as S,F as L,r as k,o as $,n as j,J as O,p as Y,s as V}from"./index.0523a5a3.js";import{S as n,A as f}from"./commonEnum.da040d67.js";import{g as x}from"./formValidateService.5ed66daa.js";const i={Page:{url:n.MATERIALS+"/buyTask/page",method:r.POST},customPage:{url:n.MATERIALS+"/buyTask/customPage",method:r.POST},Save:{url:n.MATERIALS+"/buyTask",method:r.POST},Update:{url:n.MATERIALS+"/buyTask",method:r.PUT},Delete:{url:n.MATERIALS+"/buyTask",method:r.DELETE},Query:{url:n.MATERIALS+"/buyTask/query",method:r.POST}},Q=e=>u.request(a(a({},i.customPage),{params:e})),U=e=>u.request(a(a({},i.Save),{params:e})),H=e=>u.request(a(a({},i.Update),{params:e})),N=e=>u.request(a(a({},i.Delete),{params:e})),{t:s}=I(),z=[{title:"\u7269\u6599\u540D\u79F0-\u89C4\u683C",dataIndex:"materials",width:380},{title:"\u9700\u6C42\u65E5\u671F",dataIndex:"minRequireTime"},{title:"\u672A\u91C7\u8D2D\u6570\u91CF",dataIndex:"quantity"},{title:"\u5F85\u4EA4\u4ED8\u6570\u91CF",dataIndex:"todoQuantity"},{title:"\u66F4\u65B0\u65F6\u95F4",dataIndex:"updateTime",sorter:!0,width:180}],G=[{field:"createTimeRange",label:s("lamp.common.createTime"),component:"RangePicker",colProps:{span:6}}],J=[{field:"id",label:"ID",component:"Input",show:!1},{label:s("lamp.materials.buyTask.materialsId"),field:"materialsId",component:"Input"},{label:s("lamp.materials.buyTask.skuId"),field:"skuId",component:"Input"},{label:s("lamp.materials.buyTask.minRequireTime"),field:"minRequireTime",component:"DatePicker",componentProps:{format:"YYYY-MM-DD",valueFormat:"YYYY-MM-DD",showTime:{defaultValue:q("00:00:00","HH:mm:ss")}}},{label:s("lamp.materials.buyTask.quantity"),field:"quantity",component:"Input"},{label:s("lamp.materials.buyTask.todoQuantity"),field:"todoQuantity",component:"Input"},{label:s("lamp.materials.buyTask.status"),field:"status",component:"Input"},{label:s("lamp.materials.buyTask.optionName"),field:"optionName",component:"Input"}],W=e=>[];var T=B({name:"BuyTaskEdit",components:{BasicDrawer:_,BasicForm:v},emits:["success","register"],setup(e,{emit:y}){const{t:m}=I(),o=C(f.ADD),{createMessage:b}=L(),[g,{setFieldsValue:l,resetFields:c,updateSchema:w,validate:F}]=M({labelWidth:100,schemas:J,showActionButtonGroup:!1,actionColOptions:{span:23}}),[E,{setDrawerProps:p,closeDrawer:A}]=P(async t=>{await c(),p({confirmLoading:!1}),o.value=t==null?void 0:t.type;let h=i.Save;const D=a({},t==null?void 0:t.record);S(o)===f.EDIT?h=i.Update:D.id=void 0,await l(a({},D)),x(h,W()).then(async d=>{d&&d.length>0&&await w(d)})});async function R(){try{const t=await F();p({confirmLoading:!0}),S(o)===f.EDIT?await H(t):await U(t),b.success(m(`common.tips.${o.value}Success`)),A(),y("success")}finally{p({confirmLoading:!1})}}return{t:m,registerDrawer:E,registerForm:g,type:o,handleSubmit:R}}});function K(e,y,m,o,b,g){const l=k("BasicForm"),c=k("BasicDrawer");return $(),j(c,V(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",width:"30%",maskClosable:!1,title:e.t(`common.title.${e.type}`),onOk:e.handleSubmit}),{default:O(()=>[Y(l,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}T.render=K;var X=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:T});export{X as E,T as _,z as a,Q as c,N as r,G as s};
