var t=Object.assign;import{_ as R,a as P}from"./useDrawer.803df328.js";import{_ as L}from"./BasicForm.2d8a4167.js";import{u as k}from"./useForm.96bd58a3.js";import{cu as n,be as m,j as S,d as M,w as $,x as j,D as v,F as x,r as D,o as C,n as q,J as O,p as G,s as U}from"./index.f012a3f4.js";import{S as l,A as f}from"./commonEnum.da040d67.js";import{g as V}from"./formValidateService.8fbd814e.js";const s={Page:{url:l.MATERIALS+"/categoryNode/treeTableList",method:n.GET},Save:{url:l.MATERIALS+"/categoryNode/treeNode",method:n.POST},Update:{url:l.MATERIALS+"/categoryNode",method:n.PUT},Delete:{url:l.MATERIALS+"/categoryNode",method:n.DELETE},Query:{url:l.MATERIALS+"/categoryNode/query",method:n.POST}},E=e=>m.request(t(t({},s.Page),{params:e})),z=e=>m.request(t(t({},s.Save),{params:e})),H=e=>m.request(t(t({},s.Update),{params:e})),J=e=>m.request(t(t({},s.Delete),{params:e})),{t:o}=S(),Q=[{title:o("lamp.materials.categoryNode.name"),dataIndex:"name",width:380},{title:o("lamp.materials.categoryNode.orderIndex"),dataIndex:"orderIndex",width:80},{title:o("lamp.materials.categoryNode.remark"),dataIndex:"remark"},{title:o("lamp.common.createTime"),dataIndex:"createTime",sorter:!0,width:180}],W=[],K=[{field:"id",label:"ID",component:"Input",show:!1},{label:"\u4E0A\u7EA7\u5206\u7C7B",field:"parentId",component:"CategorySelect",componentProps:{api:E,multiple:!1}},{label:o("lamp.materials.categoryNode.name"),field:"name",component:"Input"},{label:o("lamp.materials.categoryNode.orderIndex"),field:"orderIndex",component:"Input"},{label:o("lamp.materials.categoryNode.visible"),field:"visible",component:"RadioButtonGroup",componentProps:{options:[{label:o("lamp.common.yes"),value:!0},{label:o("lamp.common.no"),value:!1}]}},{label:o("lamp.materials.categoryNode.remark"),field:"remark",component:"Input"},{label:o("lamp.materials.categoryNode.version"),field:"version",component:"Input",show:!1},{label:o("lamp.materials.categoryNode.isDelete"),field:"isDelete",component:"RadioButtonGroup",show:!1,componentProps:{options:[{label:o("lamp.common.yes"),value:!0},{label:o("lamp.common.no"),value:!1}]}}],X=e=>[];var g=M({name:"CategoryNodeEdit",components:{BasicDrawer:R,BasicForm:L},emits:["success","register"],setup(e,{emit:y}){const{t:i}=S(),r=$(f.ADD),{createMessage:h}=x(),[I,{setFieldsValue:c,resetFields:d,appendSchemaByField:A,updateSchema:_,validate:N}]=k({labelWidth:100,schemas:K,showActionButtonGroup:!1,actionColOptions:{span:23}});j(()=>{});const[F,{setDrawerProps:p,closeDrawer:T}]=P(async a=>{await d(),p({confirmLoading:!1}),r.value=a==null?void 0:a.type;let w=s.Save;const b=t({},a==null?void 0:a.record);v(r)===f.EDIT?w=s.Update:b.id=void 0,await c(t({},b)),V(w,X()).then(async u=>{u&&u.length>0&&await _(u)})});async function B(){try{const a=await N();p({confirmLoading:!0}),a.parentId&&a.parentId.length>0?a.parentId=a.parentId[0]:a.parentId=-1,v(r)===f.EDIT?await H(a):await z(a),h.success(i(`common.tips.${r.value}Success`)),T(),y("success")}finally{p({confirmLoading:!1})}}return{t:i,registerDrawer:F,registerForm:I,appendSchemaByField:A,type:r,handleSubmit:B}}});function Y(e,y,i,r,h,I){const c=D("BasicForm"),d=D("BasicDrawer");return C(),q(d,U(e.$attrs,{onRegister:e.registerDrawer,showFooter:"",width:"30%",maskClosable:!1,title:e.t(`common.title.${e.type}`),onOk:e.handleSubmit}),{default:O(()=>[G(c,{onRegister:e.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}g.render=Y;var Z=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:g});export{Z as E,g as _,Q as c,E as p,J as r,W as s};
