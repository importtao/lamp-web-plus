var s=Object.assign;import{_ as E,a as A}from"./useDrawer.1dca4d34.js";import{_ as B}from"./BasicForm.8a90524a.js";import{u as O}from"./useForm.1103fde3.js";import{cu as n,be as m,j as w,d as j,w as U,D as S,F as $,r as D,o as k,n as q,J as x,p as H,s as C}from"./index.b7a14d4f.js";import{S as l,A as f}from"./commonEnum.da040d67.js";import{g as L}from"./formValidateService.993b7545.js";import{f as Y}from"./general.aeae067e.js";const r={Page:{url:l.AUTHORITY+"/role/page",method:n.POST},Save:{url:l.AUTHORITY+"/role",method:n.POST},Update:{url:l.AUTHORITY+"/role",method:n.PUT},Delete:{url:l.AUTHORITY+"/role",method:n.DELETE},Query:{url:l.AUTHORITY+"/role/query",method:n.POST}},V=o=>m.request(s(s({},r.Page),{params:o})),G=o=>m.request(s(s({},r.Save),{params:o})),M=o=>m.request(s(s({},r.Update),{params:o})),z=o=>m.request(s(s({},r.Delete),{params:o})),{t:e}=w(),J=[{title:e("lamp.system.role.name"),dataIndex:"name"},{title:e("lamp.system.role.code"),dataIndex:"code"},{title:e("lamp.system.role.describe"),dataIndex:"describe"},{title:e("lamp.system.role.state"),dataIndex:"state"},{title:e("lamp.system.role.readonly"),dataIndex:"readonly"},{title:e("lamp.system.role.dsType"),dataIndex:"dsType"},{title:e("lamp.common.createTime"),dataIndex:"createTime",sorter:!0,width:180}],N=[{label:e("lamp.system.role.name"),field:"name",component:"Input",colProps:{span:5}},{label:e("lamp.system.role.code"),field:"code",component:"Input",colProps:{span:5}},{field:"createTimeRange",label:e("lamp.common.createTime"),component:"RangePicker",colProps:{span:6}}],Q=[{field:"id",label:"ID",component:"Input",show:!1},{label:e("lamp.system.role.name"),field:"name",component:"Input"},{label:e("lamp.system.role.code"),field:"code",component:"Input"},{label:e("lamp.system.role.describe"),field:"describe",component:"Input"},{label:e("lamp.system.role.state"),field:"state",component:"RadioButtonGroup",componentProps:{options:[{label:e("lamp.common.yes"),value:!0},{label:e("lamp.common.no"),value:!1}]}},{label:e("lamp.system.role.readonly"),field:"readonly",component:"RadioButtonGroup",componentProps:{options:[{label:e("lamp.common.yes"),value:!0},{label:e("lamp.common.no"),value:!1}]}},{label:e("lamp.system.role.dsType"),field:"dsType",component:"ApiSelect",componentProps:{api:Y,params:["DataScopeType"],resultField:"DataScopeType"}}],W=o=>[];var y=j({name:"RoleEdit",components:{BasicDrawer:E,BasicForm:B},emits:["success","register"],setup(o,{emit:T}){const{t:c}=w(),t=U(f.ADD),{createMessage:b}=$(),[g,{setFieldsValue:i,resetFields:p,updateSchema:v,validate:_}]=O({labelWidth:100,schemas:Q,showActionButtonGroup:!1,actionColOptions:{span:23}}),[R,{setDrawerProps:d,closeDrawer:F}]=A(async a=>{await p(),d({confirmLoading:!1}),t.value=a==null?void 0:a.type;let h=r.Save;const I=s({},a==null?void 0:a.record);S(t)===f.EDIT?h=r.Update:I.id=void 0,await i(s({},I)),L(h,W()).then(async u=>{u&&u.length>0&&await v(u)})});async function P(){try{const a=await _();d({confirmLoading:!0}),S(t)===f.EDIT?await M(a):await G(a),b.success(c(`common.tips.${t.value}Success`)),F(),T("success")}finally{d({confirmLoading:!1})}}return{t:c,registerDrawer:R,registerForm:g,type:t,handleSubmit:P}}});function K(o,T,c,t,b,g){const i=D("BasicForm"),p=D("BasicDrawer");return k(),q(p,C(o.$attrs,{onRegister:o.registerDrawer,showFooter:"",width:"30%",maskClosable:!1,title:o.t(`common.title.${o.type}`),onOk:o.handleSubmit}),{default:x(()=>[H(i,{onRegister:o.registerForm},null,8,["onRegister"])]),_:1},16,["onRegister","title","onOk"])}y.render=K;var X=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",default:y});export{X as E,y as _,J as c,V as p,z as r,N as s};
